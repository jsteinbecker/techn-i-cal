<!--
SCHEDULE DETAIL VIEW 
``view.scheduleDetail``

-->

{% extends 'base.html' %}
{% load slippers %} {% load django_tables2 %}


{% block style %}
    <style>
        body {
            background-image: url('/static/img/Geode_seamlessOlive.png');
            background-repeat: repeat;
            background-size: 30%;
        }
    </style>
{% endblock style %}
    

{% block content %}
    
    <div class="panel text text-center">
        <h1 class="text-3xl text-amber-600 text-bold">

                {{schedule.year}}-Schedule {{schedule.number}}
                    
        </h1> 
        <h3 class="text-lg text-amber-300 text-light">
        
                    VERSION {{schedule.version}}   
        </h3>

        <div class="text-xs text-gray-300 italic">

        <output id="weather" 
                name="weather"
                _="on load 
                    remove @hidden from #WarnLowCount when my value 
                    is < 200"
                    value="{{ schedule.slots.filled.count }}">
            {{ schedule.slots.filled.count }} 
            / {{ schedule.slots.all.count }} 
            SLOTS ASSIGNED 
        </output>

        <div 
            id="WarnLowCount" 
            hidden>
            WARNING! 
            LOW COVERAGE!
        </div> 

    </div>

    <div class="bg-slate-800 rounded-lg w-fc p-4 vstack">
        <div class="hstack">
            <a href="{% url 'sch:sch-detail-slot-table' schedule.pk %}">
                Slot Table </a>
        </div>
        <div class="hstack">
            {% if schedule.slots.tdoConflicts.exists %}
                <div class="w-5 h-5 border border-2 border-red-400 bg-gradient-to-r from-red-600 to-black text-black rounded-full font-bold text-xs">
                    <span class="text-2xs">{{ schedule.slots.tdoConflicts.count }}</span>
                </div>
            {% else %}
                <i class="text-green-400"> âœ“ </i>
            {% endif %} 
        <a href="{% url 'sch:sch-tdo-conflicts' schedule.pk %}">Day Off Conflicts</a>
        </div>
    </div>

    <div><a href="{% url 'sch:v1-schedule-detail' schedule.pk %}"> 
        ALTERNATE VIEW </a></div>
    <div 
        class="float-left w-9 h-9 mx-2
            text-center text center
            mt-6 my-5 rounded-full border border-4        
            border-slate-500 font-light
        {% if schedule.percent < 90 %} 
            ring ring-offset-2 ring-amber-400 text-amber-200
        {% else %} 
            ring ring-offset-2 ring-green-200 text-green-400 
        {% endif %}">
    {{ schedule.percent }}% 
</div>
    <div>
    <div class="float-right mx-6">
            <form method="POST"> {% csrf_token %}
            {{ actionDropdown }}
                {# ACTIONS DROPDOWN BUTTON #} 
                {#______SOLVE W/ALGORITHM___#}
                {#______SOLVE w/MACH.LEARNING___#}
                {#______DELETE SCHEDULE SLOTS___#}
            </form> 
    </div>
    </div>
    
            <div class="overflow-x-auto"> 
                    {# ========= SCHEDULE TABLE ========= #}
                    {% include 'sch2/schedule/complex-table.html' %}
            </div>
       

</div>
    <form method="POST"> {% csrf_token %}
        <h2>Access Employee PTO Management for this schedule</h2>
            
            {{ form }}

        <button type="submit">SUBMIT</button>
    </form>

    <form method="POST" action="{% url 'sch:sch-time-pref-fill' schedule.pk %}"> 
        {% csrf_token %}
        <input type="submit" value="Perform Time-Preference Aware Fill"/>
    </form>

<div class="panel">

    <h3>Schedule PTO Requests</h3>
    <div class="hstack">
        <div class="vstack center text text-center">
            <div class="h-9 w-9 animate animate-spin text-lg border border-white rounded-full shadow-lg align-baseline align-content">
                {{ schedule.pto_requests.all.count }} </div>
            <div class="text-2xs text-slate-900 italic font-light">
                PTO Requests
            </div>
        </div>
        <div class="vstack center text text-center">
            <div class="h-9 w-9 border border-white rounded-full text-red-600">
                {{ schedule.pto_requests.violated.count }} </div>
            <div class="text-2xs text-red-800 italic font-light">
                Violated
            </div>
        </div>
    </div>
    
    <div class="font-extrabold text-amber-300">({{ schedule.pto_requests.violated.count }} violated)</div>

</div>

    
{% endblock content %} 
    