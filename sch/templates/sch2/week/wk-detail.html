{% extends 'base.html' %}
{% load tags %}


{% block content %}

    <nav>
        <form action="{% url 'sch:v2-week-fill-templates' week.pk %}"
              method="POST"> {% csrf_token %}
        <input type="submit"
            class="bg-sky-100 text-sky-800 hover:bg-sky-200 p-2 m-2 rounded" 
            value="FILL TEMPLATES"/>
        </form>
        
        <form action="{% url 'sch:v2-week-clear-slots' week.pk %}"
              method="POST"> {% csrf_token %}
        <input type="submit"
        hx-confirm="Verify {{week.slots.all.count}} slots will be cleared out."
            class="bg-rose-200 text-rose-600 hover:bg-rose-500 hover:text-rose-100" 
            value="CLEAR SLOTS IN WEEK"/>
        </form>
    </nav>

    <h1 class="text-2xl text-amber-300">{{ week }}</h1>
    <div class="flex flex-row">

    {% for workday in workdays %}
    <a href="{{workday.url}}">
        <div class="panel">
            <div 
            class= "text-2xs text-bold text-amber-300">
            {{ workday.weekday }}</div>

            <h3 
            class="text-lg"> 
            {{ workday.date }} Schedule</h3>

                <table class='x-overflow-scroll'>
                    <th class="px-3">
                        <tr><span class="text-2xs text-gray-399 px-3">Shift</span></tr>
                        <tr><span class="text-2xs text-gray-300 px-3">Assigned to</span></tr>
                    </th>
                    {% for slot in workday.slots.all %}
                        <tr>
                            <td> {{ slot.shift.name }} </td>
                            <td> {{ slot.employee }} </td>
                        </tr>
                    {% endfor %}
                </table>

                <div>{{ workday.percent }}% Filled</div>

            
        </div>
    </a>
        
    {% endfor %}
    </div>
    
    <div>

    {% regroup slots by employee as slotCount %}

    {% for empl in slotCount %}
        <p> {{ empl.grouper }} <span class="bg-gray-200 text-gray-800 text-xs">{% sumSlotHours empl.list %}</span> </p> 
        <div></div> 
        {% for slot in empl.list %}
            <span class='bg-blue-600 text-white text-xs italic px-2 rounded-lg'>{{ slot }}</span>
        {% endfor %}     
    {% endfor slot %}
    
    </div>

    
{% endblock content %}